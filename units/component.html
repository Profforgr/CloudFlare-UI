<!DOCTYPE html>
<html lang="en">
    <head>
        <title>CloudFlare UI Component Unit Tests</title>
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        
        <link rel="stylesheet" media="screen" href="/css/qunit.css" />
        <link rel="stylesheet" media="screen" href="/css/cloudflare.ui.core.css" />
        <link rel="stylesheet" media="screen" href="/css/cloudflare.ui.component.css" />
        
        
    </head>
    <body>
        
        <h1 id="qunit-header">CloudFlare UI Component Unit Tests</h1>
        <h2 id="qunit-banner"></h2>
        <h2 id="qunit-userAgent"></h2>
        <ol id="qunit-tests"></ol>
        
        <div id="CompOne"></div>
        <div id="CompTwo"></div>
        
        <script type="text/javascript" src="/javascript/jquery/jquery-1.4.2.min.js"></script>
        <script type="text/javascript" src="/javascript/jquery/qunit.js"></script>
        <script type="text/javascript" src="/javascript/cloudflare/cloudflare.ui.core.js"></script>
        <script type="text/javascript" src="/javascript/cloudflare/cloudflare.ui.component.js"></script>
        <script type="text/javascript">
            
            $(function() {
                
                $.cf.component(
                    'cf.Foo',
                    {
                        initialize: function(options) {
                            
                            var self = this;
                            self.setting = options.setting;
                        },
                        baseMethod: function() {
                            
                            return false;
                        },
                        assignClass: function() {
                            
                            var self = this;
                            self._element.addClass('fooClass');
                        },
                        hasSetting: function() {
                            
                            var self = this;
                            return self.setting == true;
                        },
                        setValue: function(valueOne, valueTwo) {
                            
                            var self = this;
                            self.value = valueOne + '.' + valueTwo;
                        },
                        getValue: function() {
                            var self = this;
                            return self.value;
                        },
                        getElement: function() {
                            
                            var self = this;
                            return self._element;
                        }
                    }
                );
                
                $.cf.component(
                    'cf.Bar',
                    $.cf.Foo,
                    {
                        initialize: function(options) {
                            
                            var self = this;
                            self.superMethod(options);
                        },
                        assignClass: function() {
                            
                            var self = this;
                            self._element.addClass('barClass');
                            self.superMethod();
                        }
                    }
                )
                
                test(
                    "Component factory pattern",
                    function() {
                        stop();
                        
                        try {
                            
                            var foo = $('#CompOne').Foo();
                            var bar = $('#CompTwo').Bar({ setting: true });
                            
                            if(foo.is('div') && bar.is('div')) {
                                
                                ok(true, "Component constructor appropriately yielded the target element as a return value.");
                            } else {
                                
                                ok(false, "Component constructor failed to yield the target element as a return value!");
                            }
                            
                            if(foo['Foo'] && foo['Bar']) {
                                
                                ok(true, "jQuery prototype has successfully spawned component construction wrappers.");
                            } else {
                                
                                ok(false, "jQuery prototype failed to spawn component construction wrappers!");
                            }
                            
                            if(foo.data('Foo') && bar.data('Bar')) {
                                
                                ok(true, "DOM elements are associated with the appropriate component data.");
                            } else {
                                
                                ok(false, "DOM elements failed to be associated with component data!");
                            }
                            
                            if(foo.Foo('baseMethod') === false) {
                                
                                ok(true, "Method called on a component yielded a return value.");
                            } else {
                                
                                ok(false, "Method called on a component failed to yield a return value!");
                            }
                            
                            if(foo.Foo('getElement').get(0) === foo.get(0)) {
                                
                                ok(true, "Component has a valid reference to the appropriate DOM element.");
                            } else {
                                
                                ok(false, "Component does not have a valid reference to the appropriate DOM element!");
                            }
                            
                            if(bar.Bar('hasSetting')) {
                                
                                ok(true, "Subcomponent successfully inherited settings initialized by the base component.");
                            } else {
                                
                                ok(false, "Subcomponent failed to inherit settings initialized by the base component!");
                            }
                            
                            bar.Bar('assignClass');
                            
                            if(bar.hasClass('fooClass') && bar.hasClass('barClass')) {
                                
                                ok(true, "Component method successfully performed polymorphic manipulation of a DOM element.");
                            } else {
                                
                                ok(false, "Component method failed to perform polymorphic manipulation of a DOM element!");
                            }
                            
                            foo.Foo('setValue', "someValue", "otherValue");
                            
                            if(foo.Foo('getValue') == "someValue.otherValue") {
                                
                                ok(true, "Component method successfully fielded multiple arguments in a method call.");
                            } else {
                                
                                ok(false, "Component method failed to field multiple arguments in a method call!");
                            }
                            
                        } catch(e) {
                            
                            ok(false, "An exception was thrown while performing test operations: " + e);
                        }
                        
                        start();
                    }
                );
            });
        </script>
    </body>
</html>